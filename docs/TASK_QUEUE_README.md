# 任务队列功能说明

## 功能概述

工具箱现已实现任务队列功能，允许用户提交多个任务并让它们在后台异步处理。用户可以在等待任务完成的同时继续使用其他功能。

## 主要特性

### 1. 任务队列管理
- **并发控制**: 同时最多执行2个任务，其余任务在队列中等待
- **自动处理**: 任务按提交顺序自动执行
- **实时进度**: 显示每个任务的实时执行进度
- **状态追踪**: 支持多种任务状态（等待中、执行中、已完成、失败、已取消）

### 2. 支持的任务类型
- ✅ **视频快捷方式创建**: 批量创建视频文件快捷方式
- ✅ **7z转ZIP**: 解压7z文件，提取视频并转换为ZIP
- ✅ **图片打包**: 将图片文件夹批量打包为ZIP

### 3. 队列面板
- 📋 **固定位置**: 右下角浮动面板，始终可见
- 🔄 **实时更新**: 自动更新任务状态和进度
- 📊 **详细信息**: 显示任务类型、创建时间、执行结果
- 🎯 **快捷操作**: 可取消等待中的任务，清除已完成的任务

## 使用方法

### 提交任务

1. **视频快捷方式**
   - 扫描并选择视频文件
   - 设置目标文件夹和命名方式
   - 点击"🚀 创建快捷方式"按钮
   - 任务自动添加到队列

2. **7z转ZIP**
   - 扫描并选择7z文件
   - 设置视频输出目录和转换选项
   - 点击"开始转换"按钮
   - 任务自动添加到队列

3. **图片打包**
   - 扫描并选择包含图片的文件夹
   - 设置输出目录和压缩级别
   - 点击"开始打包"按钮
   - 任务自动添加到队列

### 管理任务

#### 查看任务队列
- 任务队列面板默认在右下角展开
- 点击"▼"按钮可收起/展开队列面板
- 每个任务显示：
  - 任务名称和类型
  - 当前状态（等待中/执行中/已完成等）
  - 执行进度（执行中的任务）
  - 执行结果（成功/失败数量）

#### 取消任务
- 只能取消"等待中"的任务
- 点击任务右侧的"取消"按钮
- 正在执行的任务无法取消

#### 清除已完成任务
- 点击队列面板顶部的"清除已完成"按钮
- 一键清除所有已完成、失败或已取消的任务

## 任务状态说明

| 状态 | 图标 | 说明 | 颜色 |
|------|------|------|------|
| 等待中 | ⏳ | 任务已提交，等待执行 | 黄色 |
| 执行中 | ▶️ | 任务正在执行，显示进度条 | 蓝色 |
| 已完成 | ✅ | 任务成功完成 | 绿色 |
| 失败 | ❌ | 任务执行失败，显示错误信息 | 红色 |
| 已取消 | 🚫 | 用户手动取消的任务 | 灰色 |

## 技术实现

### 后端（Main Process）
- **TaskQueue类**: 管理任务队列的核心类
  - 任务添加和调度
  - 并发控制（最多2个并发任务）
  - 任务执行和状态管理
  - IPC通信，向前端推送更新

### 前端（Renderer Process）
- **任务队列面板**: 固定在右下角的浮动面板
- **实时更新**: 监听后端推送的任务状态变化
- **交互控制**: 取消任务、清除已完成任务
- **状态可视化**: 不同状态用不同颜色和图标表示

### IPC通信
- `task-queue-add`: 添加任务到队列
- `task-queue-get-all`: 获取所有任务
- `task-queue-cancel`: 取消任务
- `task-queue-clear-completed`: 清除已完成任务
- `task-update`: 任务状态更新事件
- `task-list-update`: 任务列表更新事件

## 优势

1. **提高效率**: 无需等待一个任务完成就可以继续添加新任务
2. **并发处理**: 同时执行多个任务，充分利用系统资源
3. **状态透明**: 清楚了解每个任务的执行状态
4. **易于管理**: 统一的队列面板管理所有任务
5. **用户友好**: 自动处理，无需手动干预

## 未来改进方向

- [ ] 支持任务优先级设置
- [ ] 支持暂停/恢复正在执行的任务
- [ ] 任务历史记录持久化
- [ ] 更详细的任务执行日志
- [ ] 任务完成通知
- [ ] 可配置的并发任务数量
