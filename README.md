# 多功能文件工具

一个基于 Electron 的跨平台桌面应用，包含多种实用工具：

1. **🎬 视频快捷方式提取器** - 提取指定目录下的视频文件并创建快捷方式
2. **📦 7z转ZIP转换器** - 将7z文件转换为zip文件，自动提取视频文件
3. **🖼️ 图片打包工具** - 将多个图片文件夹批量打包为ZIP压缩包
4. **📚 TXT转EPUB转换器** - 将TXT小说文件转换为EPUB电子书，支持自动章节识别
5. **🌐 图库抓取工具** - 从在线图库网站抓取图片并打包为ZIP

## 功能特点

### 🎬 视频快捷方式提取器

- 🔍 **递归扫描** - 扫描选定文件夹及所有子文件夹中的视频文件
- 🎬 **多格式支持** - 支持 MP4、AVI、MKV、MOV、WMV、FLV、WebM 等常见视频格式
- 📁 **灵活命名** - 支持多种命名方式：
  - 文件夹名_文件名（推荐）
  - 仅文件夹名
  - 保持原文件名
- 🖥️ **跨平台** - 支持 Windows、macOS 和 Linux
- ✅ **批量处理** - 支持批量创建快捷方式，显示进度

### 📦 7z转ZIP转换器

- 🔄 **格式转换** - 将7z压缩包转换为zip格式
- 📹 **视频提取** - 自动将视频文件从压缩包中提取到指定文件夹
- 🖼️ **图片保留** - 图片和其他非视频文件保留在zip中
- ⚡ **批量处理** - 支持同时处理多个7z文件
- 🔧 **灵活选项** - 可选择是否保留原始7z文件
- 📊 **压缩级别** - 支持多种压缩级别（极速/快速/平衡/最高压缩）

### 🖼️ 图片打包工具

- 📁 **批量打包** - 将多个子文件夹中的图片分别打包为ZIP
- 🖼️ **多格式支持** - 支持 JPG、PNG、GIF、BMP、WebP、TIFF 等常见图片格式
- 📛 **智能命名** - ZIP文件以子文件夹名称命名
- ⚡ **快速处理** - 支持多种压缩级别选择
- 📊 **详细统计** - 显示打包成功数量和总图片数量

### 📚 TXT转EPUB转换器

- 📖 **智能章节识别** - 自动识别常见章节标题格式（第X章、第X节、Chapter X等）
- 🔤 **多编码支持** - 自动检测并支持 UTF-8、GBK、UTF-16 等编码格式
- 📑 **目录生成** - 自动生成带有目录的标准EPUB文件
- 🎨 **预览功能** - 支持预览章节解析结果
- ✏️ **自定义规则** - 支持自定义正则表达式匹配章节标题
- 👤 **作者设置** - 可设置电子书作者信息

### 🌐 图库抓取工具

- 🔍 **关键字搜索** - 支持中文关键字搜索在线图库
- 📦 **自动打包** - 每个图库自动打包成独立的ZIP文件
- 🔢 **顺序编号** - 图片按顺序编号保存，保持原始顺序
- ⚡ **并发下载** - 支持并发下载，提升抓取速度
- 🔄 **失败重试** - 支持断点续传和失败自动重试
- ❌ **可取消** - 支持随时取消正在进行的抓取任务

### 📋 任务队列系统

- 🔄 **后台处理** - 任务添加后自动在后台异步处理
- ⚡ **并发控制** - 同时最多执行2个任务，其余任务在队列中等待
- 📊 **实时进度** - 显示每个任务的实时执行进度
- 🎯 **状态追踪** - 支持多种任务状态（等待中、执行中、已完成、失败、已取消）
- 🧹 **队列管理** - 可取消等待中的任务，一键清除已完成任务

## 安装

### 前置要求

- [Node.js](https://nodejs.org/) (v16 或更高版本)
- npm 或 yarn

### 安装依赖

```bash
cd getVedioLnk
npm install
```

## 运行

### 开发模式

```bash
npm run build:dev && npm start
```

或者使用热重载模式：
```bash
npm start
```

### 打包应用

打包为当前平台：
```bash
npm run build
```

打包为指定平台：
```bash
# macOS
npm run build:mac

# Windows
npm run build:win

# Linux
npm run build:linux
```

打包后的应用会生成在 `dist` 目录中。

## 使用方法

### 视频快捷方式提取器

1. **选择源文件夹** - 点击"浏览..."选择包含视频文件的文件夹
2. **扫描视频** - 点击"扫描视频文件"按钮，应用会递归扫描所有视频文件
3. **选择视频** - 在列表中勾选需要创建快捷方式的视频文件
4. **选择目标文件夹** - 点击"浏览..."选择保存快捷方式的位置
5. **选择命名方式** - 选择快捷方式的命名规则
6. **创建快捷方式** - 点击"创建快捷方式"按钮，任务会添加到队列

### 7z转ZIP转换器

1. **切换到7z转ZIP选项卡** - 点击顶部的"📦 7z转ZIP"标签
2. **选择7z文件所在文件夹** - 点击"浏览..."选择包含7z文件的文件夹
3. **扫描7z文件** - 点击"扫描7z文件"按钮
4. **选择要转换的文件** - 在列表中勾选需要转换的7z文件
5. **设置视频提取目录** - 选择视频文件的存放位置
6. **选择压缩级别** - 根据需要选择压缩速度
7. **开始转换** - 点击"开始转换"按钮，任务会添加到队列

转换完成后：
- 📦 每个7z文件会被转换为同名的zip文件（保存在原位置）
- 🖼️ 图片和其他非视频文件保留在zip中
- 📹 视频文件会被提取到指定的视频目录

### 图片打包工具

1. **切换到图片打包选项卡** - 点击顶部的"🖼️ 图片打包"标签
2. **选择源文件夹** - 选择包含多个子文件夹的目录
3. **扫描子文件夹** - 点击"扫描子文件夹"按钮
4. **选择要打包的文件夹** - 在列表中勾选需要打包的子文件夹
5. **设置输出目录** - 选择ZIP文件的保存位置
6. **选择压缩级别** - 根据需要选择压缩速度
7. **开始打包** - 点击"开始打包"按钮，任务会添加到队列

### TXT转EPUB转换器

1. **切换到TXT转EPUB选项卡** - 点击顶部的"📚 TXT转EPUB"标签
2. **选择TXT文件** - 可选择扫描文件夹或选择单个文件
3. **预览章节（可选）** - 选中文件后点击"预览章节"查看解析结果
4. **设置输出目录** - 选择EPUB文件的保存位置
5. **设置作者（可选）** - 输入作者名称
6. **自定义章节规则（可选）** - 如默认规则不满足需求，可输入自定义正则表达式
7. **开始转换** - 点击"开始转换"按钮

### 图库抓取工具

1. **切换到图库抓取选项卡** - 点击顶部的"🖼️ 图库抓取"标签
2. **输入关键字** - 在搜索框中输入关键字并点击搜索
3. **选择图库** - 在搜索结果中勾选需要抓取的图库
4. **设置输出目录** - 选择ZIP文件的保存位置
5. **开始抓取** - 点击"开始抓取"按钮
6. **取消抓取（可选）** - 如需中断，点击"取消抓取"按钮

### 任务队列

- 任务队列面板位于窗口右下角
- 显示所有任务的状态和进度
- 可以取消等待中的任务
- 点击"清除已完成"可一键清除已完成的任务
- 点击"▼/▲"按钮可收起/展开队列面板

## 快捷方式类型

- **Windows**: 创建 `.lnk` 快捷方式文件
- **macOS**: 创建符号链接（symlink）
- **Linux**: 创建符号链接（symlink）

## 支持的视频格式

- MP4, AVI, MKV, MOV, WMV, FLV, WebM
- M4V, MPEG, MPG, 3GP, 3G2, TS, MTS
- M2TS, VOB, OGV, RM, RMVB, ASF, DIVX

## 支持的图片格式

- JPG, JPEG, PNG, GIF, BMP, WebP
- TIFF, TIF, ICO, SVG, HEIC, HEIF
- RAW, PSD

## 项目结构

```
getVedioLnk/
├── main.js              # Electron 主进程
├── preload.js           # 预加载脚本
├── src/
│   ├── index.html       # 用户界面
│   ├── styles.css       # 样式文件
│   └── renderer.js      # 渲染进程脚本
├── webpack.config.js    # Webpack 配置
├── package.json         # 项目配置
└── README.md            # 说明文档
```

## 开发

### 技术栈

- Electron 28
- HTML5 / CSS3 / JavaScript (ES6+)
- Node.js
- Webpack 5 (代码打包)
- 7zip-min (7z文件处理)
- archiver (zip文件创建)
- JSZip (JavaScript ZIP处理)
- cheerio (HTML解析)
- iconv-lite (字符编码转换)
- epub-gen-memory (EPUB生成)

### 启用开发者工具

在 `main.js` 中取消注释以下行：

```javascript
mainWindow.webContents.openDevTools();
```

### 构建流程

项目使用 Webpack 进行前端代码打包：

```bash
# 开发模式构建
npm run build:dev

# 生产模式构建
npm run build:prod
```

## 注意事项

- 在 macOS 和 Linux 上，快捷方式实际上是符号链接
- Windows 上需要管理员权限才能创建符号链接，因此使用 `.lnk` 快捷方式
- 如果源视频文件被移动或删除，快捷方式将失效
- 图库抓取工具需要网络连接，请确保网络畅通
- TXT转EPUB工具会自动检测文件编码，但某些特殊编码可能需要手动转换

## 许可证

MIT License
